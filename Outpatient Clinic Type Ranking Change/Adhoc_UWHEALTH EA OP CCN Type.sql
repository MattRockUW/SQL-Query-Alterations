/****** Object:  View [Mart_UWHealth].[EA_OP_CCN_TYPE]    Script Date: 2/3/2025 3:45:06 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [Adhoc_UWHealth].[EA_OP_CCN_TYPE]
AS 
SELECT
/**********************************************************************************
Author: Sean Meirose
This object is a view against the Clarity cost center table that assigns the priorities 
to specific CCNs that are used in the OP encounter type assignment
2/4/25 MAR - Changed OP_ENC_HIERARCHY to be an int, not a varchar to have intended ordering
**************************************************************************************/

CCN.RPT_GRP_FOUR AS GL_COST_CENTER_ID
,CASE
	WHEN CCN.RPT_GRP_FOUR LIKE '3040%' THEN 'AMBSRG'
	WHEN CCN.RPT_GRP_FOUR IN ('3032186','3032045','3032112') THEN 'CATHEP'
	WHEN CCN.RPT_GRP_FOUR = '3033223' THEN 'MEDFLT'
	WHEN CCN.RPT_GRP_FOUR LIKE '3033%' THEN 'EMERG'
	WHEN CCN.RPT_GRP_FOUR IN ('3030341','3030489', '3030197','3035094') THEN 'CLPROC'
	WHEN CCN.RPT_GRP_FOUR IN ('3030272','3035274') THEN 'CHEMOI'
	WHEN CCN.RPT_GRP_FOUR IN ('3030388','3030389','3030386') THEN 'RTX'
	WHEN CCN.RPT_GRP_FOUR = '3034093' THEN 'GENRAD'
	WHEN CCN.RPT_GRP_FOUR LIKE '3034%' THEN 'ADVRAD'
	WHEN CCN.RPT_GRP_FOUR LIKE '3030%' OR CCN.RPT_GRP_FOUR = '3035066' THEN 'CLVIST'
	WHEN CCN.RPT_GRP_FOUR = '3032366' THEN 'CRDRHB'
	WHEN CCN.RPT_GRP_FOUR LIKE '3038%' THEN 'REHAB'
	WHEN CCN.RPT_GRP_FOUR LIKE '3032%' THEN 'OTHDIA'
	WHEN CCN.RPT_GRP_FOUR IN ('3039549','3035178','3039496') THEN 'HOMEH'
	WHEN CCN.RPT_GRP_FOUR LIKE '3035%' AND CCN.RPT_GRP_FOUR NOT IN ('3035066','3035094') THEN 'OBSOTHER'
	WHEN CCN.RPT_GRP_FOUR LIKE '3041%' THEN 'REGSVC'
	WHEN CCN.RPT_GRP_FOUR LIKE '3031%' THEN 'LABS'
	WHEN CCN.RPT_GRP_FOUR LIKE '3037%' THEN 'RX'
	ELSE 'OTHER'
	END AS OP_ENC_TYPE
,CASE
	WHEN CCN.RPT_GRP_FOUR LIKE '3040%' THEN 'Ambulatory Surgery'
	WHEN CCN.RPT_GRP_FOUR IN ('3032186','3032045','3032112') THEN 'Cath/EP Laboratory'
	WHEN CCN.RPT_GRP_FOUR = '3033223' THEN 'Med Flight'
	WHEN CCN.RPT_GRP_FOUR LIKE '3033%' THEN 'Emergency Room'
	WHEN CCN.RPT_GRP_FOUR IN ('3030341','3030489','3030197','3035094') THEN 'Clinic Procedure: GI, Uro, Endo'
	WHEN CCN.RPT_GRP_FOUR IN ('3030272','3035274') THEN 'Chemother, Infusions'
	WHEN CCN.RPT_GRP_FOUR IN ('3030388','3030389','3030386') THEN 'Radiotherapy'
	WHEN CCN.RPT_GRP_FOUR = '3034093' THEN 'General Radiology'
	WHEN CCN.RPT_GRP_FOUR LIKE '3034%' THEN 'Advanced Radiology'
	WHEN CCN.RPT_GRP_FOUR LIKE '3030%' OR CCN.RPT_GRP_FOUR = '3035066' THEN 'Clinic Visit'
	WHEN CCN.RPT_GRP_FOUR = '3032366' THEN 'Cardiac Rehab'
	WHEN CCN.RPT_GRP_FOUR LIKE '3038%' THEN 'Rehabilitation'
	WHEN CCN.RPT_GRP_FOUR LIKE '3032%' THEN 'Other Diagnostic'
	WHEN CCN.RPT_GRP_FOUR IN ('3039549','3035178','3039496') THEN 'Home Health'
	WHEN CCN.RPT_GRP_FOUR LIKE '3035%' AND CCN.RPT_GRP_FOUR NOT IN ('3035066','3035094') THEN 'Other Temp Patient'
	WHEN CCN.RPT_GRP_FOUR LIKE '3041%' THEN 'Regional Services'
	WHEN CCN.RPT_GRP_FOUR LIKE '3031%' THEN 'Laboratory'
	WHEN CCN.RPT_GRP_FOUR LIKE '3037%' THEN 'Pharmacy Only'
	ELSE 'Other Outpatient Encounter'
	END AS OP_ENC_TYPE_DESC
,CASE
	WHEN CCN.RPT_GRP_FOUR LIKE '3040%' THEN 100
	WHEN CCN.RPT_GRP_FOUR IN ('3032186','3032045','3032112') THEN 200
	WHEN CCN.RPT_GRP_FOUR = '3033223' THEN 300
	WHEN CCN.RPT_GRP_FOUR LIKE '3033%' THEN 400
	WHEN CCN.RPT_GRP_FOUR IN ('3030341','3030489', '3030197','3035094') THEN 600
	WHEN CCN.RPT_GRP_FOUR IN ('3030272','3035274') THEN 800
	WHEN CCN.RPT_GRP_FOUR IN ('3030388','3030389','3030386') THEN 900
	WHEN CCN.RPT_GRP_FOUR = '3034093' THEN 1200
	WHEN CCN.RPT_GRP_FOUR LIKE '3034%' THEN 950
	WHEN CCN.RPT_GRP_FOUR LIKE '3030%' OR CCN.RPT_GRP_FOUR = '3035066' THEN 1000
	WHEN CCN.RPT_GRP_FOUR = '3032366' THEN 1100
	WHEN CCN.RPT_GRP_FOUR LIKE '3038%' THEN 1150
	WHEN CCN.RPT_GRP_FOUR LIKE '3032%' THEN 1300
	WHEN CCN.RPT_GRP_FOUR IN ('3039549','3035178','3039496') THEN 1500
	WHEN CCN.RPT_GRP_FOUR LIKE '3035%' AND CCN.RPT_GRP_FOUR NOT IN ('3035066','3035094') THEN 1400
	WHEN CCN.RPT_GRP_FOUR LIKE '3041%' THEN 1600
	WHEN CCN.RPT_GRP_FOUR LIKE '3031%' THEN 1800
	WHEN CCN.RPT_GRP_FOUR LIKE '3037%' THEN 1900
	ELSE 9999
	END AS OP_ENC_HIERARCHY
FROM
SOURCE_UWHEALTH.EPIC_CL_COST_CNTR_CUR CCN
WHERE CCN.RPT_GRP_FOUR IS NOT NULL;
GO


